<!DOCTYPE html>
<html lang="en">
  
  
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta charset="utf-8">
	<meta name="keywords" content="HTML5, php, web development">
    <meta name="description" content="We are developing web solutions using HTML5, javascript, PhP, Java, etc">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="scripts/jquery.tablesort.min.js"></script>
	<script src="scripts/jquery.tablesort.js"></script>
	<link href="styles/style1.css" rel="stylesheet">
	
    <title>Parse books.xml</title>
    <style>
	body{padding-top:50px; padding-bottom:50px;}
	html{scroll-padding-top: 55px;}
	</style>
    <script>
	$(document).ready(function(){ 
	$("#navhere").load("navbar.htm"); 
	$("#findbooks").click(function(){
	$("#table1").empty();    // make empty before next search 
	
	$.ajax({
	type: "GET",
	url: "books.xml",
	dataType: "xml",
	success:function(data){
	$("#table1").append('<thead id="tbth"></thead><tbody id="tbtb"></tbody>');
	var h='<tr><th>Title</th><th>Publisher</th><th>Author</th><th>Price</th><th>Year</th></tr>';
	$("#tbth").append(h);
	$(data).find('book').each(function(){
	var title=$(this).find('title').text();  // XML data
	var publisher= $(this).find('publisher').text();  // XML data
	var price= parseFloat($(this).find('price').text()); 
	var year= parseInt($(this).find('year').text()); 
	
	var authors="";
	var authArr=$(this).find('author');
	authArr.each(function(key,value){
	authors=authors+$(value).text()+"<br>";
	}); // end of author search
	
	printOK=true;
	
	var cat = $("#cat").val();  // selection from drop-down menu
	var catAtr = $(this).attr("category");
	if(cat!=catAtr && cat!="all")  
	     printOK=false;
	
	var lang = $("#lang").val();  // selection from drop-down menu
	var langAtr = $(this).find("title").attr("lang");
	if(lang!=langAtr && lang!="all")  
	     printOK=false;
	
	var minyear = $("#minYear").val(); // from html field MinYear
	var maxyear = $("#maxYear").val(); // from html field MaxYear
	if(minyear.length>0 && year<parseInt(minyear))
	    printOK=false;
	if(maxyear.length>0 && year>parseInt(maxyear))
	    printOK=false;
	
	var minprice = $("#minPrice").val(); // from html field MinPrice
	var maxprice = $("#maxPrice").val(); // from html field MaxPrice
	if(minprice.length>0 && price<parseFloat(minprice))
	    printOK=false;
	if(maxprice.length>0 && price>parseFloat(maxprice))
	    printOK=false;
	
	// make filter by price: individual work
	
	if(printOK)
	{
	var r='<tr><td>'+title+'</td><td>'+publisher+'</td><td>'+authors+'</td><td>'+price+'</td><td>'+year+'</td></tr>';
	$("#tbtb").append(r);
	}
	
	}); // end of find book(each)
	$("#table1").tablesort();

	},  // end of success part
	error:function(){alert("HELP...SOS");}
	
	});    // end of ajax
	
	
	});  // end of findbooks 
	
	});   // end of documenty ready
	</script>
  
  
  
  </head>
  <body>
  <div id="navhere"></div>
 <header>
    <h1>Parse books.xml</h1>
 </header> 
 <div style="margin-left:10px">
 <br><br>
 Min Price <input type="number" id="minPrice" /> &nbsp;&nbsp; 
 Max Price <input type="number" id="maxPrice" /><br>
 
 <br>
 Min Year &nbsp;<input type="number" id="minYear" /> &nbsp;&nbsp; &nbsp; 
 Max Year <input type="number" id="maxYear" /><br>
 
 <br>
 <select id="cat">
 <option value="all">Select category</option>
 <option value="cooking">Cooking</option>
 <option value="children">Children</option>
  <option value="web">Web</option>
  <option value="comedy">Comedy</option>
  <option value="serious">Serious</option>
 </select>
 <br>
 
 <br>
 <select id="lang">
 <option value="all">Select language</option>
 <option value="en">English</option>
 <option value="et">Estonian</option>
 </select>
 <br>
     
  <br> 
 <button id="findbooks">Find Books</button><br><br>
 <table id="table1" class="table-bordered" style="background-color:#ABFFED" ></table>
 <br>
</div>
  <footer class="fixed-bottom">
  &copy; Copyright. Fox. All rights reserved. <br> Tallinn Suur Sõjamäe 10A
  </footer>
  </body>
  
</html>
